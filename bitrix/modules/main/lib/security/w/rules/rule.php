<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1418395415']= array(base64_decode('aXNfc3Ry'.'aW5n'),base64_decode(''.'c3Ryd'.'G9sb3dl'.'cg=='),base64_decode(''.'a'.'X'.'N'.'f'.'YX'.'JyYX'.'k='),base64_decode('aXNf'.'c'.'3RyaW5n'),base64_decode(''.'Z3'.'pkZ'.'WNv'.'ZG'.'U='),base64_decode('YmF'.'zZTY'.'0X2RlY29kZQ='.'='),base64_decode('dXJsZ'.'GVjb'.'2Rl'),base64_decode('YX'.'JyYXl'.'fcm'.'V2ZXJ'.'zZQ=='),base64_decode('Z3plbmN'.'vZGU='),base64_decode('Y'.'mFzZT'.'Y0'.'X2'.'VuY29'.'k'.'ZQ=='),base64_decode('dX'.'JsZW5'.'j'.'b2'.'Rl'),base64_decode('YmluMm'.'hl'.'eA'.'=='),base64_decode('aX'.'NfYX'.'J'.'yYXk='),base64_decode(''.'c3RydG9'.'sb3d'.'l'.'c'.'g=='),base64_decode('aXNfYXJy'.'YXk'.'='),base64_decode('am9pbg=='),base64_decode('Zm'.'5tYXRjaA='.'='),base64_decode(''.'cmF'.'3dXJsZ'.'GVjb2R'.'l'),base64_decode(''.'c3'.'V'.'ic3Ry'),base64_decode('c3'.'Vic'.'3Ry'),base64_decode('c3Ry'.'X3Jlc'.'GxhY2U='),base64_decode('c'.'HJlZ19'.'xd'.'W90'.'ZQ=='),base64_decode('cHJlZ'.'19tYX'.'RjaA=='));if(!function_exists(__NAMESPACE__.'\\___336479003')){function ___336479003($_2008003139){static $_2079749256= false; if($_2079749256 == false) $_2079749256=array(''.'YW'.'N0'.'aW9'.'u','aW50d'.'mF'.'s','cGF0aA'.'==',''.'Y'.'2'.'9udGV'.'4dA='.'=',''.'a2V5c'.'w==','cH'.'JvY2'.'Vz'.'cw='.'=','ZW'.'5jb2Rp'.'bmc=','cHJ'.'lZ19'.'yZXBsYWNl','cGF0aA==',''.'Y2'.'9'.'udGV4'.'dA==','a'.'2V5cw==','c'.'HJvY2Vzcw==','ZW5jb2'.'Rpb'.'mc=',''.'cG'.'F0dGVybg='.'=','cHJlZ19'.'tYXRj'.'aA==','c'.'GF'.'0a'.'A==','Y29udGV4dA==','a2'.'V'.'5cw==',''.'c'.'HJvY2Vzcw==','ZW5jb2'.'Rpb'.'mc=','c'.'GF0'.'dGVy'.'bg==','cG9zd'.'F9'.'hY3R'.'pb2'.'4=',''.'Y2hlY2tfY3NyZ'.'g==','cGF'.'0aA==','Y'.'29'.'u'.'dG'.'V4'.'dA'.'==',''.'a2V'.'5'.'c'.'w==',''.'cHJ'.'vY2Vzcw==','ZW5jb2Rpb'.'mc'.'=','cG'.'F0d'.'GVyb'.'g='.'=','YWN0aW'.'9'.'u','YW'.'N0aW9u','Y'.'W'.'N0aW9u','Y'.'W'.'N0aW9u','YWN0aW9'.'u','YW'.'N0aW9u','cG'.'9'.'zdF9hY3Rpb'.'24=','Z'.'W5jb2Rpbm'.'c=','ZW5jb'.'2'.'Rpbmc'.'=','ZW5'.'j'.'b2Rpb'.'mc=',''.'ZW'.'5jb'.'2R'.'pb'.'mc=','ZW5'.'jb'.'2Rpbmc'.'=','Z'.'W5jb2'.'R'.'pb'.'mc=','Z3o=',''.'Ym'.'Fz'.'ZT'.'Y0','dXJs',''.'aGV4','L'.'g='.'=','L'.'w==','aW5kZXguc'.'Ghw','L'.'2luZGV4LnBocA'.'==','U0NSSV'.'B'.'UX'.'05B'.'TUU=','L2luZGV4L'.'n'.'Bo'.'cA='.'=','U0NSSVBUX05BT'.'U'.'U'.'=','U0NSS'.'VBU'.'X05B'.'TUU=',''.'U0NSSVBUX05BT'.'UU=','fg==','f'.'l4=','f'.'g==','XH4=','JH4=');return base64_decode($_2079749256[$_2008003139]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_951570082; protected $_1801034948; protected $_731626868; protected $_1800826581; protected $_2089250322; public static function make(array $_409990919):?static{ $_409990919= static::prepareRuleParameters($_409990919); return match($_409990919[___336479003(0)]){ ___336479003(1) => new IntvalRule( $_409990919[___336479003(2)], $_409990919[___336479003(3)], $_409990919[___336479003(4)], $_409990919[___336479003(5)], $_409990919[___336479003(6)]), ___336479003(7) => new PregReplaceRule( $_409990919[___336479003(8)], $_409990919[___336479003(9)], $_409990919[___336479003(10)], $_409990919[___336479003(11)], $_409990919[___336479003(12)], $_409990919[___336479003(13)]), ___336479003(14) => new PregMatchRule( $_409990919[___336479003(15)], $_409990919[___336479003(16)], $_409990919[___336479003(17)], $_409990919[___336479003(18)], $_409990919[___336479003(19)], $_409990919[___336479003(20)], $_409990919[___336479003(21)]), ___336479003(22) => new CsrfRule( $_409990919[___336479003(23)], $_409990919[___336479003(24)], $_409990919[___336479003(25)], $_409990919[___336479003(26)], $_409990919[___336479003(27)], $_409990919[___336479003(28)],), default => null,};} protected static function prepareRuleParameters(array $_1465270043): array{ if($GLOBALS['____1418395415'][0]($_1465270043[___336479003(29)])){ $_1465270043[___336479003(30)]= $GLOBALS['____1418395415'][1]($_1465270043[___336479003(31)]);} elseif($GLOBALS['____1418395415'][2]($_1465270043[___336479003(32)])){ $_1536967154= $_1465270043[___336479003(33)]; $_1465270043[___336479003(34)]= $_1536967154[(800-2*400)]; $_1465270043[___336479003(35)]= $_1536967154[round(0+0.2+0.2+0.2+0.2+0.2)];} $_1465270043[___336479003(36)]=!empty($_1465270043[___336479003(37)])? $_1465270043[___336479003(38)]:[]; if($GLOBALS['____1418395415'][3]($_1465270043[___336479003(39)])){ $_1465270043[___336479003(40)]=[$_1465270043[___336479003(41)]];} return $_1465270043;}  public function __construct($_951570082, $_1801034948, $_731626868, $_1800826581, $_2089250322){ $this->_951570082= $_951570082; $this->_1801034948= $this->castContext($_1801034948); $this->_731626868= $this->castKeys($_731626868); $this->_1800826581= $_1800826581; $this->_2089250322= $_2089250322;} public function evaluateValue($_1697539475){ if(!empty($this->_2089250322)){ foreach($this->_2089250322 as $_1678342415){ $_1697539475= match($_1678342415){ 'gz' => $GLOBALS['____1418395415'][4]($_1697539475), 'base64' => $GLOBALS['____1418395415'][5]($_1697539475), 'url' => $GLOBALS['____1418395415'][6]($_1697539475), 'hex' => hex2bin($_1697539475)};}} $_174966427= $this->evaluate($_1697539475); if(!empty($this->_2089250322) && $_174966427 instanceof ModifyResult){ $_1048861100= $_174966427->getCleanValue(); foreach($GLOBALS['____1418395415'][7]($this->_2089250322) as $_1678342415){ $_1048861100= match($_1678342415){ ___336479003(42) => $GLOBALS['____1418395415'][8]($_1048861100), ___336479003(43) => $GLOBALS['____1418395415'][9]($_1048861100), ___336479003(44) => $GLOBALS['____1418395415'][10]($_1048861100), ___336479003(45) => $GLOBALS['____1418395415'][11]($_1048861100)};} $_174966427= new ModifyResult($_1048861100);} return $_174966427;} abstract public function evaluate($_1697539475); protected function castContext($_1801034948){ if(!$GLOBALS['____1418395415'][12]($_1801034948)){ $_1801034948=[$_1801034948];} foreach($_1801034948 as $_677567314 => $_390574034){ $_1801034948[$_677567314]= $GLOBALS['____1418395415'][13]($_390574034);} return $_1801034948;} protected function castKeys($_731626868){ if(!$GLOBALS['____1418395415'][14]($_731626868)){ $_731626868=[$_731626868];} return $_731626868;} public function matchKey(array $_1531031721): bool{ $_1531031721= $GLOBALS['____1418395415'][15](___336479003(46), $_1531031721); foreach($this->_731626868 as $_1932444537){   if($GLOBALS['____1418395415'][16]($_1932444537, $_1531031721)){ return true;}} return false;}  public function matchPath($_778416062){ if($this->_951570082 === '*'){ return true;}  $_278581028= new Uri($_778416062); $_822378819= $_278581028->getPath(); $_822378819= $GLOBALS['____1418395415'][17]($_822378819);      if(str_ends_with($_822378819, ___336479003(47))){ $_822378819 .= ___336479003(48);} $_822378819= Path::normalize($_822378819);  $_1442127967[]= $_822378819; if(str_ends_with($_822378819, ___336479003(49))){ $_1442127967[]= $GLOBALS['____1418395415'][18]($_822378819,(137*2-274),-round(0+4.5+4.5));} elseif(str_ends_with($_SERVER[___336479003(50)], ___336479003(51))){ $_1442127967[]= $GLOBALS['____1418395415'][19]($_SERVER[___336479003(52)],(904-2*452),-round(0+1.8+1.8+1.8+1.8+1.8));} if($_822378819 !== $_SERVER[___336479003(53)]){ $_1442127967[]= $_SERVER[___336479003(54)];}  if(str_starts_with($this->_951570082, ___336479003(55))){ $_1177121044= $this->_951570082;} else{ $_1177121044= ___336479003(56). $GLOBALS['____1418395415'][20](___336479003(57), ___336479003(58), $GLOBALS['____1418395415'][21]($this->_951570082)). ___336479003(59);} foreach($_1442127967 as $_1123946721){ if($this->_951570082 === $_1123946721 || $GLOBALS['____1418395415'][22]($_1177121044, $_1123946721)){ return true;}} return false;}  public function getPath(){ return $this->_951570082;}  public function getContext(){ return $this->_1801034948;}  public function getKeys(){ return $this->_731626868;}  public function getProcess(){ return $this->_1800826581;}}?>